{% extends 'base.html' %}

{% block title %}Dashboard - C2 Platform{% endblock %}

{% block content %}
<div class="card">
    <h2>üñ•Ô∏è Server Information</h2>
    <div class="info-grid">
        <div class="info-item">
            <strong>Hostname:</strong>
            <span>{{ server_info.hostname }}</span>
        </div>
        <div class="info-item">
            <strong>Local IP:</strong>
            <span style="font-family: monospace; color: #28a745;">{{ server_info.local_ip }}</span>
        </div>
        <div class="info-item">
            <strong>External IP:</strong>
            <span style="font-family: monospace; color: #007bff;">{{ server_info.external_ip }}</span>
        </div>
        <div class="info-item">
            <strong>Platform:</strong>
            <span>{{ server_info.platform }} {{ server_info.platform_version }}</span>
        </div>
        <div class="info-item">
            <strong>Python Version:</strong>
            <span>{{ server_info.python_version }}</span>
        </div>
        <div class="info-item">
            <strong>Server Time:</strong>
            <span>{{ server_info.uptime }}</span>
        </div>
    </div>
</div>

<div class="card">
    <h2>üìä Statistics</h2>
    <div class="stats-grid">
        <div class="stat-box">
            <h3>{{ stats.total_agents }}</h3>
            <p>Total Agents</p>
        </div>
        <div class="stat-box">
            <h3>{{ stats.active_agents }}</h3>
            <p>Active Agents</p>
        </div>
        <div class="stat-box">
            <h3>{{ stats.total_commands }}</h3>
            <p>Total Commands</p>
        </div>
        <div class="stat-box">
            <h3>{{ stats.pending_commands }}</h3>
            <p>Pending Commands</p>
        </div>
    </div>
</div>

{% if agents %}
<div class="card">
    <h2>üëæ Recent Agents</h2>
    <table>
        <thead>
            <tr>
                <th>Agent ID</th>
                <th>Hostname</th>
                <th>IP Address</th>
                <th>Platform</th>
                <th>Status</th>
                <th>Last Seen</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for agent in agents %}
            <tr>
                <td style="font-family: monospace;">{{ agent.agent_id|truncatechars:12 }}</td>
                <td>{{ agent.hostname }}</td>
                <td>{{ agent.ip_address }}</td>
                <td>{{ agent.platform }}</td>
                <td>
                    {% if agent.status == 'active' %}
                        <span class="badge badge-success">Active</span>
                    {% elif agent.status == 'idle' %}
                        <span class="badge badge-warning">Idle</span>
                    {% else %}
                        <span class="badge badge-danger">Offline</span>
                    {% endif %}
                </td>
                <td>{{ agent.last_seen|date:"Y-m-d H:i:s" }}</td>
                <td>
                    <a href="{% url 'agent_detail' agent.agent_id %}" class="btn btn-primary" style="padding: 0.5rem 1rem; font-size: 0.875rem;">View</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <div style="margin-top: 1rem; text-align: center;">
        <a href="{% url 'agents' %}" class="btn btn-primary">View All Agents</a>
    </div>
</div>
{% endif %}

{% endblock %}
